<!DOCTYPE HTML>
<html>
    <head>
    <meta charset="utf-8">
    <title>Beer Buddy</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <style type="text/css" media="screen">@import "/jqtouch/themes/css/jqtouch.css";</style>
    <style type="text/css" media="screen">
		.validation
		{
			color: #E71212;
		}
	</style>
    <script src="/jqtouch/src/jqtouch.js" type="text/javascript" charset="utf-8"></script>
    <script src="/jqtouch/src/jqtouch-jquery.min.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript">
      // Fire up JQTouch
      var jQT = $.jQTouch({
        statusBar: 'black'
      });
	  
	  function OfferInfo(canSize, cansInPack, numberOfPacks, cost) {
		  this.CanSize = canSize;
		  this.CansInPack = cansInPack;
		  this.NumberOfPacks = numberOfPacks;
		  this.Cost = cost;
	  }
	  
	  OfferInfo.prototype.getPricePer100ml = function () {
		  var totalCans = this.CansInPack * this.NumberOfPacks;
		  var totalMl = totalCans * this.CanSize;
		  var total100Mls = totalMl / 100;
		  return this.Cost / total100Mls;
	  }
	  
	  OfferInfo.prototype.compare = function (otherOffer) {
		  if (this.getPricePer100ml() < otherOffer.getPricePer100ml()){
			  return this;
		  }
		  else {
			  return otherOffer;
		  }
	  }
	    
	  $(document).ready(function() {
		  $('#brawlbutton').click(function (){
			  // get offer one info
			  var offer1 = new OfferInfo();
			  offer1.CanSize = $("#cansize1").val();
			  offer1.CansInPack = $("#cansinpack1").val();
			  offer1.NumberOfPacks = $("#numberofpacks1").val();
			  offer1.Cost = $("#cost1").val();
			  			  
			  // get offer two info
			  var offer2 = new OfferInfo();
			  offer2.CanSize = $("#cansize2").val();
			  offer2.CansInPack = $("#cansinpack2").val();
			  offer2.NumberOfPacks = $("#numberofpacks2").val();
			  offer2.Cost = $("#cost2").val();
			  
			  // calculate winner
			  var offer1per100ml = offer1.getPricePer100ml();
			  var offer2per100ml = offer2.getPricePer100ml();		  
			  
			  // show result
			  var $result = $("#result");
			  var resultHeadline = (offer1per100ml < offer2per100ml) ? "Offer 1 wins!" : "Offer 2 wins!";
//			  var amountSaved = ""
				  
			  $result
			  	.append("<h1>" + resultHeadline + "</h1>")
				.append("<h2>Cost per 100ml</h2>")
			  	.append("<p>Offer 1 = " + offer1per100ml.toFixed(2) + "</p>")
			  	.append("<p>Offer 2 = " + offer2per100ml.toFixed(2) + "</p>");				
		  });
		  
		  $("#startover").click(function(e) {
            resetBeerBrawl();
        });
		
		$("#winnerstayson").change(function(e) {
            winnerStaysOn();
        });
  
			$('#offer1').bind('pageAnimationStart', function(e, data){
				if (data.direction == 'out')
				{
					validateRequiredField(e, "#cansize1", "Can Size");
					validateRequiredField(e, "#cansinpack1", "Cans In Pack");
					validateRequiredField(e, "#numberofpacks1", "Number Of Packs");
					validateRequiredField(e, "#cost1", "Offer Cost");
				}
			});
			
			$('#offer2').bind('pageAnimationStart', function(e, data){
				if (data.direction == 'out')
				{
					validateRequiredField(e, "#cansize2", "Can Size");
					validateRequiredField(e, "#cansinpack2", "Cans In Pack");
					validateRequiredField(e, "#numberofpacks2", "Number Of Packs");
					validateRequiredField(e, "#cost2", "Offer Cost");
				}
			});
			
					
	  });
	  	  
	  function validateRequiredField(e, selector, name) {
		if($(selector).val() == "") {
		  $(selector).next(".validation").text(name + " is required!");
		  e.preventDefault();
		}		  
		else {
		  $(selector).next(".validation").empty();	
		}
	  }
	  
	  function resetBeerBrawl() {
		  $(".input").val("");
		  $(".validation").empty();
		  $("#result").empty();
	  }
	  
	  function winnerStaysOn() {
		  // calculate winner
		  // reset 
		  // populate page 1 with winner
	  }
    </script>
    </head>

    <body>
    <div id="jqt">
      <div id="offer1">
        <div class="toolbar">
          <h1>Beer Brawl</h1>
        </div>
        <ul class="edit rounded">
          <li>
            <input type="number" name="cansize1" class="input" placeholder="Can Size (ml)" id="cansize1" />
            <div class="validation"></div>
          </li>
          <li>
            <input type="number" name="cansinpack1" class="input" placeholder="Cans In Pack" id="cansinpack1" />
            <div class="validation"></div>
          </li>
          <li>
            <input type="number" name="numberofpacks1" class="input" placeholder="Number Of Packs" id="numberofpacks1" />
            <div class="validation"></div>
          </li>
          <li>
            <input type="number" name="cost1" class="input" placeholder="Cost" id="cost1" />
            <div class="validation"></div>
          </li>
        </ul>
        <ul class="rounded">
          <li>
	          <a class="greenButton" href="#offer2">Add Contender</a>
          </li>
        </ul>
      </div>
      <div id="offer2">
        <div class="toolbar">
          <h1>Add Contender</h1>
          <a href="#" class="back">Back</a> </div>
        <ul class="edit rounded">
          <li>
            <input type="number" name="cansize2" class="input" placeholder="Can Size (ml)" id="cansize2" />
            <div class="validation"></div>
          </li>
          <li>
            <input type="number" name="cansinpack2" class="input" placeholder="Cans In Pack" id="cansinpack2" />
            <div class="validation"></div>
          </li>
          <li>
            <input type="number" name="numberofpacks2" class="input" placeholder="Number Of Packs" id="numberofpacks2" />
            <div class="validation"></div>
          </li>
          <li>
            <input type="number" name="cost2" class="input" placeholder="Cost" id="cost2" />
            <div class="validation"></div>
          </li>
        </ul>
        <ul class="rounded">
          <li><a class="greenButton" id="brawlbutton" href="#brawl">Brawl!</a></li>
        </ul>
      </div>
      <div id="brawl">
        <div class="toolbar">
          <h1>Brawl Winner</h1>
        </div>
        <ul class="edit rounded">
          <li id="result"></li>
        </ul>
        <ul class="rounded">
          <li><a class="greenButton" id="winnerstayson" href="#offer2">Winner Stays On</a></li>
          <li><a class="redButton" id="startover" href="#offer1">Start Over</a></li>
        </ul>
      </div>
    </div>
</body>
</html>
