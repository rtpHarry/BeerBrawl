<!DOCTYPE HTML>
<html>
    <head>
    <meta charset="utf-8">
    <title>Beer Buddy</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <style type="text/css" media="screen">@import "/jqtouch/themes/css/jqtouch.css";</style>
    <style type="text/css" media="screen">
		.validation
		{
			color: #E71212;
		}
	</style>
    <script src="/jqtouch/src/jqtouch.js" type="text/javascript" charset="utf-8"></script>
    <script src="/jqtouch/src/jqtouch-jquery.min.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript">
      // Fire up JQTouch
      var jQT = $.jQTouch({
        statusBar: 'black'
      });
	  
	  $(document).ready(function() {
		  $('#brawlbutton').click(function (){
			  // get offer one info
			  var cansize1 = $("#cansize1").val();
			  var cansinpack1 = $("#cansinpack1").val();
			  var numberofpacks1 = $("#numberofpacks1").val();
			  var cost1 = $("#cost1").val();
			  			  
			  // get offer two info
			  var cansize2 = $("#cansize2").val();
			  var cansinpack2 = $("#cansinpack2").val();
			  var numberofpacks2 = $("#numberofpacks2").val();
			  var cost2 = $("#cost2").val();
			  
			  // calculate winner
			  var offer1per100ml = getPricePer100ml(cansize1, cansinpack1, numberofpacks1, cost1);
			  var offer2per100ml = getPricePer100ml(cansize2, cansinpack2, numberofpacks2, cost2);		  
			  
			  // show result
			  var $result = $("#result");
			  var resultSnippet = (offer1per100ml < offer2per100ml) ? "Offer 1 wins!" : "Offer 2 wins!";
			 // var savingSnippet = "Total Saved = " + getTotalSaving(offer1per100ml, offer2per100ml, ;
				  
			  $result
			  	.append("<h1>" + resultSnippet + "</h1>")
				.append("<h2>Cost per 100ml</h2>")
			  	.append("<p>Offer 1 = " + offer1per100ml.toFixed(2) + "</p>")
			  	.append("<p>Offer 2 = " + offer2per100ml.toFixed(2) + "</p>");				
		  });
		  
		  $("#startover").click(function(e) {
            resetBeerBrawl();
        });
  
			$('#offer1').bind('pageAnimationStart', function(e, data){
				if (data.direction == 'out')
				{
					validateRequiredField(e, "#cansize1", "Can Size");
					validateRequiredField(e, "#cansinpack1", "Cans In Pack");
					validateRequiredField(e, "#numberofpacks1", "Number Of Packs");
					validateRequiredField(e, "#cost1", "Offer Cost");
				}
			});
			
			$('#offer2').bind('pageAnimationStart', function(e, data){
				if (data.direction == 'out')
				{
					validateRequiredField(e, "#cansize2", "Can Size");
					validateRequiredField(e, "#cansinpack2", "Cans In Pack");
					validateRequiredField(e, "#numberofpacks2", "Number Of Packs");
					validateRequiredField(e, "#cost2", "Offer Cost");
				}
			});			
	  });
	  
	  function getPricePer100ml(cansize, cansinpack, numberofpacks, cost) {
		  var totalCans = cansinpack * numberofpacks;
		  var totalMl = totalCans * cansize;
		  var total100Mls = totalMl / 100;
		  return cost / total100Mls;
	  }
	  
	  function validateRequiredField(e, selector, name) {
		if($(selector).val() == "") {
		  $(selector).next(".validation").text(name + " is required!");
		  e.preventDefault();
		}		  
		else {
		  $(selector).next(".validation").empty();	
		}
	  }
	  
	  function resetBeerBrawl() {
		  $(".input").val("");
		  $(".validation").empty();
		  $("#result").empty();
	  }
    </script>
    </head>

    <body>
    <div id="jqt">
      <div id="offer1">
        <div class="toolbar">
          <h1>Beer Brawl</h1>
        </div>
        <ul class="edit rounded">
          <li>
            <input type="text" name="name1" class="input" placeholder="Name (Optional)" id="name1" />
          </li>
          <li>
            <input type="number" name="cansize1" class="input" placeholder="Can Size (ml)" id="cansize1" />
            <div class="validation"></div>
          </li>
          <li>
            <input type="number" name="cansinpack1" class="input" placeholder="Cans In Pack" id="cansinpack1" />
            <div class="validation"></div>
          </li>
          <li>
            <input type="number" name="numberofpacks1" class="input" placeholder="Number Of Packs" id="numberofpacks1" />
            <div class="validation"></div>
          </li>
          <li>
            <input type="number" name="cost1" class="input" placeholder="Cost" id="cost1" />
            <div class="validation"></div>
          </li>
        </ul>
        <ul class="rounded">
          <li>
	          <a class="greenButton" href="#offer2">Add Contender</a>
          </li>
        </ul>
      </div>
      <div id="offer2">
        <div class="toolbar">
          <h1>Add Contender</h1>
          <a href="#" class="back">Back</a> </div>
        <ul class="edit rounded">
          <li>
            <input type="text" name="name2" class="input" placeholder="Name (Optional)" id="name2" />
          </li>
          <li>
            <input type="number" name="cansize2" class="input" placeholder="Can Size (ml)" id="cansize2" />
            <div class="validation"></div>
          </li>
          <li>
            <input type="number" name="cansinpack2" class="input" placeholder="Cans In Pack" id="cansinpack2" />
            <div class="validation"></div>
          </li>
          <li>
            <input type="number" name="numberofpacks2" class="input" placeholder="Number Of Packs" id="numberofpacks2" />
            <div class="validation"></div>
          </li>
          <li>
            <input type="number" name="cost2" class="input" placeholder="Cost" id="cost2" />
            <div class="validation"></div>
          </li>
        </ul>
        <ul class="rounded">
          <li><a class="greenButton" id="brawlbutton" href="#brawl">Brawl!</a></li>
        </ul>
      </div>
      <div id="brawl">
        <div class="toolbar">
          <h1>Brawl Winner</h1>
          <a href="#" class="back">Back</a> </div>
        <ul class="edit rounded">
          <li id="result"></li>
        </ul>
        <ul class="rounded">
          <li><a class="greenButton" href="#offer2">Winner Stays On</a></li>
          <li><a class="redButton" id="startover" href="#offer1">Start Over</a></li>
        </ul>
      </div>
    </div>
</body>
</html>
